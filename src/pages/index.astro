---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";
import Agenda from "../components/Agenda.jsx";
import CarteSection from "../components/CarteSection.jsx";
import LesIncontournables from "../components/LesIncontournables.jsx";
import Sejourner from "../components/Sejourner.jsx";
import InformationsPratiques from "../components/InformationsPratiques.jsx";
import Footer from "../components/Footer.jsx";
import LesPlages from "../components/LesPlages";
import ActiviteLoisir from "../components/ActiviteLoisir";
import DecouvreTerritoire from "../components/DecouvreTerritoire";
import ArtisanatTerroirReal from "../components/ArtisanatTerroirReal";
import { type RootGlobal } from "../types/gloabal";
import { type RootLandingPage } from "../types/landingpage";

import { PUBLIC_API_URL } from "astro:env/client";
import type { RootEvenements } from "../types/evenements";
console.log("API URL:", PUBLIC_API_URL);

const data = await fetch(`${PUBLIC_API_URL}/api/global`, {
  method: "GET",
  headers: {
    "Content-Type": "application/json",
  },
});

const globalData: RootGlobal = await data.json();
console.log("Global Data:", globalData);

const dataLandingPage = await fetch(`${PUBLIC_API_URL}/api/landing-page`, {
  method: "GET",
  headers: {
    "Content-Type": "application/json",
  },
});

const dataLandingPageJson: RootLandingPage = await dataLandingPage.json();
console.log("dataLandingPageJson Data:", dataLandingPageJson);

const dataEvenements = await fetch(`${PUBLIC_API_URL}/api/evenements`, {
  method: "GET",
  headers: {
    "Content-Type": "application/json",
  },
});

const dataEvenementsJson: RootEvenements = await dataEvenements.json();
console.log("dataEvenementsJson Data:", dataEvenementsJson);
---

<Layout>
  <Hero data={dataLandingPageJson.data.Hero} />
  <Agenda
    data={dataLandingPageJson.data.Agenda}
    events={dataEvenementsJson.data}
    client:load
  />
  <CarteSection data={dataLandingPageJson.data.CarteInteractive} />
  <LesIncontournables data={dataLandingPageJson.data.LesIncontournables} />
  <DecouvreTerritoire data={dataLandingPageJson.data.DecouvrezLeTerritoire} />
  <Sejourner data={dataLandingPageJson.data.Sejourner} />
  <LesPlages data={dataLandingPageJson.data.LesPlages} />
  <ArtisanatTerroirReal
    data={dataLandingPageJson.data.ArtisanatEtProduitsDuTerroir}
  />
  <ActiviteLoisir data={dataLandingPageJson.data.ActiviteLoisir} />
  <InformationsPratiques
    data={dataLandingPageJson.data.InformationsPratiques}
  />
  <Footer data={globalData} />
</Layout>
